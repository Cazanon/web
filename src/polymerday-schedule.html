<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/iron-icon/iron-icon.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/paper-tabs/paper-tabs.html">

<link rel="import" href="polymerday-data.html">
<link rel="import" href="polymerday-section-title.html">
<link rel="import" href="polymerday-schedule-item.html">

<dom-module id="polymerday-schedule">

  <template>

  <style>
    :host {
      display: block;
    }

    .wrapper {
      padding: 32px 0;
    }

    .event {
      padding: 0 24px;
    }

    .event--highlight {
      background: #E7F0F9;
    }

    polymerday-schedule-item {
      max-width: 992px;
      margin: auto;
    }

    paper-tabs {
      width: 300px;
      margin: 0 auto;
      --paper-tabs: {
        background: var(--color-blue-medium);
        color: var(--color-white-primary);
      }
    }

    paper-tab a {
      @apply(--layout-horizontal);
      @apply(--layout-center-center);
      @apply(--text-normal-white);
      text-decoration: none;
    }

    paper-tabs paper-tab.iron-selected {
      background: var(--color-blue-primary);
    }
    

  </style>

  <app-route
    route="{{route}}"
    pattern="/:day"
    data="{{routeData}}"
    tail="{{subroute}}"></app-route>

  <polymerday-section-title title="Schedule" message="We dedicate one an a half days to talk about Web Components"></polymerday-section-title>
  
  <paper-tabs selected="{{day}}" attr-for-selected="day" fallback-selection="[[defaultDay]]" role="navigation" no-bar noink>
    <paper-tab day="friday" link>
      <a href$="[[route.prefix]]/friday/">Friday</a>
    </paper-tab>
    <paper-tab day="saturday" link>
      <a href$="[[route.prefix]]/saturday/">Saturday</a>
    </paper-tab>
  </paper-tabs>

  <div class="wrapper">
    <polymerday-data id="events" data="{{events}}" page="schedule" subpage="{{day}}"></polymerday-data>
    <template is="dom-repeat" items="[[events]]">
      <div class$="event [[_computeClass(item.type)]]">
        <polymerday-schedule-item event="[[item]]" on-select="doSomething"></polymerday-schedule-item>
      </div>
    </template>
  </div>

  </template>

  <script>
    Polymer({

      is: 'polymerday-schedule',

      properties: {
        route: {
          type: Object
        },

        routeData: {
          type: Object
        },

        subroute: {
          type: Object
        },

        defaultDay: {
          type: String,
          value: 'friday'
        }
      },

      observers: [
        'selectDay(routeData.day)'
      ],

      _computeClass: function(type) {
        return type === 'activity' ? 'event--highlight' : '';
      },

      doSomething: function(e) {
        console.log(e.model.item);
      },

      selectDay: function(day) {
        day = day || this.defaultDay;
        if (this.day !== day) {
          this.day = day;

          this.async(function() {
            this.set('routeData.day', day);
          }, 50);
        }
      },
    });

  </script>

</dom-module>
